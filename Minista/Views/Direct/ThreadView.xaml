<Page x:Class="Minista.Views.Direct.ThreadView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:Minista"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      mc:Ignorable="d"
      xmlns:interactivity="using:Microsoft.Xaml.Interactivity"
      xmlns:behaviors="using:Minista.Behaviors"
      xmlns:converters="using:Minista.Converters"
      xmlns:controls="using:Microsoft.Toolkit.Uwp.UI.Controls"
      xmlns:vm="using:Minista.ViewModels.Direct"
      xmlns:localControls="using:Minista.Controls"
      xmlns:selector="using:Minista.Selectors"
      xmlns:gif="using:XamlAnimatedGif"
      xmlns:loading="using:Minista.UserControls"
      xmlns:ministaUc="using:Minista.Controls"
      xmlns:uc="using:Minista.UserControls.Direct"
      Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
      NavigationCacheMode="Enabled">
    <Page.Resources>
        <ResourceDictionary>
            <Style x:Key="GridViewItemContainerStyle"
                   TargetType="GridViewItem">
                <Setter Property="HorizontalContentAlignment"
                        Value="Stretch" />
                <Setter Property="HorizontalAlignment"
                        Value="Stretch" />
                <Setter Property="VerticalContentAlignment"
                        Value="Stretch" />
                <Setter Property="VerticalAlignment"
                        Value="Stretch" />
                <Setter Property="Margin"
                        Value="1" />
                <Setter Property="Padding"
                        Value="0" />
            </Style>

            <Style x:Key="SplitViewTogglePaneButtonStyle2"
                   TargetType="ToggleButton">
                <Setter Property="FontSize"
                        Value="20" />
                <Setter Property="FontFamily"
                        Value="{ThemeResource SymbolThemeFontFamily}" />
                <Setter Property="MinHeight"
                        Value="48" />
                <Setter Property="MinWidth"
                        Value="48" />
                <Setter Property="Margin"
                        Value="0" />
                <Setter Property="Padding"
                        Value="0" />
                <Setter Property="HorizontalAlignment"
                        Value="Left" />
                <Setter Property="VerticalAlignment"
                        Value="Top" />
                <Setter Property="HorizontalContentAlignment"
                        Value="Center" />
                <Setter Property="VerticalContentAlignment"
                        Value="Center" />
                <Setter Property="Background"
                        Value="Transparent" />
                <Setter Property="Foreground"
                        Value="{ThemeResource SystemControlForegroundBaseHighBrush}" />
                <Setter Property="Content"
                        Value="&#xE700;" />
                <Setter Property="AutomationProperties.Name"
                        Value="Menu" />
                <Setter Property="UseSystemFocusVisuals"
                        Value="True" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ToggleButton">
                            <Grid Background="{TemplateBinding Background}"
                                  x:Name="LayoutRoot">
                                <VisualStateManager.VisualStateGroups>
                                    <VisualStateGroup x:Name="CommonStates">
                                        <VisualState x:Name="Normal" />
                                        <VisualState x:Name="PointerOver">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LayoutRoot"
                                                                               Storyboard.TargetProperty="(Grid.Background)">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
                                                                            Value="{ThemeResource SystemControlHighlightListLowBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                                               Storyboard.TargetProperty="Foreground">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
                                                                            Value="{ThemeResource SystemControlHighlightAltBaseHighBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                            </Storyboard>
                                        </VisualState>
                                        <VisualState x:Name="Pressed">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LayoutRoot"
                                                                               Storyboard.TargetProperty="(Grid.Background)">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
                                                                            Value="{ThemeResource SystemControlHighlightListMediumBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                                               Storyboard.TargetProperty="Foreground">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
                                                                            Value="{ThemeResource SystemControlHighlightAltBaseHighBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                            </Storyboard>
                                        </VisualState>
                                        <VisualState x:Name="Disabled">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                                               Storyboard.TargetProperty="(TextBlock.Foreground)">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
                                                                            Value="{ThemeResource SystemControlDisabledBaseLowBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                            </Storyboard>
                                        </VisualState>
                                        <VisualState x:Name="Checked" />
                                        <VisualState x:Name="CheckedPointerOver">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LayoutRoot"
                                                                               Storyboard.TargetProperty="(Grid.Background)">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
                                                                            Value="{ThemeResource SystemControlHighlightListLowBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                                               Storyboard.TargetProperty="Foreground">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
                                                                            Value="{ThemeResource SystemControlHighlightAltBaseHighBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                            </Storyboard>
                                        </VisualState>
                                        <VisualState x:Name="CheckedPressed">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LayoutRoot"
                                                                               Storyboard.TargetProperty="(Grid.Background)">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
                                                                            Value="{ThemeResource SystemControlHighlightListMediumBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                                               Storyboard.TargetProperty="Foreground">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
                                                                            Value="{ThemeResource SystemControlHighlightAltBaseHighBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                            </Storyboard>
                                        </VisualState>
                                        <VisualState x:Name="CheckedDisabled">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                                               Storyboard.TargetProperty="(TextBlock.Foreground)">
                                                    <DiscreteObjectKeyFrame KeyTime="0"
                                                                            Value="{ThemeResource SystemControlDisabledBaseLowBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                            </Storyboard>
                                        </VisualState>
                                    </VisualStateGroup>
                                </VisualStateManager.VisualStateGroups>
                                <ContentPresenter x:Name="ContentPresenter"
                                                  Content="{TemplateBinding Content}"
                                                  Margin="{TemplateBinding Padding}"
                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                  AutomationProperties.AccessibilityView="Raw" />
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <converters:DirectItemHorizontalConverter x:Name="DirectItemHorizontalConverter" />
            <converters:StoryShareTitleConverter x:Name="StoryShareTitleConverter" />
            <converters:MediaTypeConverter x:Name="MediaTypeConverter" />
            <converters:ReelShareConverter x:Name="ReelShareConverter" />
            <converters:NullableToVisibilityConverter x:Name="NullableToVisibilityConverter" />
            <converters:DirectLinkImageConverter x:Name="DirectLinkImageConverter" />
            <converters:NumericToSeparatorConverter x:Name="NumericToSeparatorConverter" />
            <converters:AddHashtagToStringConverter x:Name="AddHashtagToStringConverter" />
            <converters:StringToUriConverter x:Name="StringToUriConverter" />
            <converters:DirectMediaShareConverter x:Name="DirectMediaShareConverter" />
            <converters:DoubleToVisibilityConverter x:Name="DoubleToVisibilityConverter" />
            <converters:DirectItemUserVisibilityConverter x:Name="DirectItemUserVisibilityConverter" />
            <converters:DirectItemUserProfilePictureConverter x:Name="DirectItemUserProfilePictureConverter" />
            <converters:ThreadItemBackgroundColorConverter x:Name="ThreadItemBackgroundColorConverter" />

            <converters:CommentColorConverter x:Key="CommentColorConverter" />
            <converters:CommentBooleanConverter x:Key="CommentBooleanConverter" />
            <converters:BooleanToVisibiltyConverter x:Key="BooleanToVisibiltyConverter" />
            <converters:MaterialHeartConverter x:Key="MaterialHeartConverter" />
            <converters:DirectItemDateTimeConverter x:Key="DirectItemDateTimeConverter" />
            <converters:DirectItemSendingMessageVisibilityConverter x:Key="DirectItemSendingMessageVisibilityConverter" />
            <converters:DirectItemSendingMessageColorConverter x:Key="DirectItemSendingMessageColorConverter" />
            <converters:DirectItemSendingMessageTikTextConverter x:Key="DirectItemSendingMessageTikTextConverter" />


            <selector:ThreadItemTemplateSelector x:Key="ThreadItemTemplateSelector"
                                                 NotSupportedTemplate="{StaticResource NotSupportedTemplate}"
                                                 TextTemplate="{StaticResource TextTemplate}"
                                                 MediaShareTemplate="{StaticResource MediaShareTemplate}"
                                                 MediaTemplate="{StaticResource MediaTemplate}"
                                                 PlaceholderTemplate="{StaticResource PlaceholderTemplate}"
                                                 NoTemplate="{StaticResource NoTemplate}"
                                                 StoryShareTemplate="{StaticResource StoryShareTemplate}"
                                                 ProfileTemplate="{StaticResource ProfileTemplate}"
                                                 FelixShareTemplate="{StaticResource FelixShareTemplate}"
                                                 RavenMediaTemplate="{StaticResource RavenMediaTemplate}"
                                                 LocationMediaTemplate="{StaticResource LocationMediaTemplate}"
                                                 ReelShareMediaTemplate="{StaticResource ReelShareMediaTemplate}"
                                                 HashtagMediaTemplate="{StaticResource HashtagMediaTemplate}"
                                                 VoiceMediaTemplate="{StaticResource VoiceMediaTemplate}"
                                                 LikeTemplate="{StaticResource LikeTemplate}"
                                                 LinkMediaTemplate="{StaticResource LinkMediaTemplate}"
                                                 LiveViewerInviteTemplate="{StaticResource LiveViewerInviteTemplate}"
                                                 VideoCallEventTemplate="{StaticResource VideoCallEventTemplate}"
                                                 AnimatedMediaTemplate="{StaticResource AnimatedMediaTemplate}"
                                                 ActionLogTemplate="{StaticResource ActionLogTemplate}"
                                                 EmptyStoryShareTemplate="{StaticResource EmptyStoryShareTemplate}"
                                                 EmptyReelShareMediaTemplate="{StaticResource EmptyReelShareMediaTemplate}" />

            <DataTemplate x:Key="LikeTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                            <MenuFlyoutItem Text="Copy Text"
                                            DataContext="{Binding}"
                                            Click="CopyTextFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid MinHeight="50"
                              MaxWidth="360"
                              BorderThickness="1"
                              CornerRadius="25"
                              Margin="5">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Foreground="#FFCDCDCD"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="35"
                                       TextWrapping="Wrap"
                                       TextAlignment="DetectFromContent"
                                       VerticalAlignment="Center"
                                       Margin="15 2"
                                       Text="{Binding Text}" />
                            <Grid Grid.Row="1"
                                  HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Foreground="#FF858585"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="10.5"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                                <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Grid.Column="1"
                                           FontFamily="{StaticResource MaterialSymbolFont}"
                                           FontSize="{StaticResource TinyLargeFontSize}"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>

                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="StoryShareTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                            <MenuFlyoutItem Text="Copy Text"
                                            DataContext="{Binding}"
                                            Click="CopyTextFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}"
                          Grid.RowSpan="2">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid BorderBrush="#FF252525"
                              MinHeight="50"
                              BorderThickness="1"
                              MaxWidth="340"
                              MinWidth="240"
                              Height="360"
                              CornerRadius="25"
                              Margin="5">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Foreground="White"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource TinyFontSize}"
                                       TextWrapping="Wrap"
                                       TextAlignment="DetectFromContent"
                                       VerticalAlignment="Center"
                                       Margin="15 2"
                                       DataContext="{Binding Converter={StaticResource StoryShareTitleConverter}}"
                                       DataContextChanged="TextBlockDataContextChanged" />
                            <controls:ImageEx HorizontalAlignment="Stretch"
                                              Grid.Row="1"
                                              VerticalAlignment="Stretch">
                                <controls:ImageEx.Background>
                                    <ImageBrush Stretch="Fill">
                                        <ImageBrush.ImageSource>
                                            <BitmapImage UriSource="{Binding StoryShare.Media.Images[0].Uri}" />
                                        </ImageBrush.ImageSource>
                                    </ImageBrush>
                                </controls:ImageEx.Background>
                            </controls:ImageEx>
                            <Grid Grid.Row="2"
                                  HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Foreground="#FF858585"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="10.5"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                                <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Grid.Column="1"
                                           FontFamily="{StaticResource MaterialSymbolFont}"
                                           FontSize="{StaticResource TinyLargeFontSize}"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>

                            <Grid Grid.RowSpan="3"
                                  Background="Cyan"
                                  Opacity="0"
                                  Tapped="StoryShareGridTapped"
                                  DataContext="{Binding}" />
                        </Grid>

                    </Grid>

                    <Grid Grid.Column="1"
                          Grid.Row="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          MaxWidth="285"
                          BorderThickness="0"
                          Margin="5 -5 5 5"
                          Visibility="{Binding Reactions.Visibility,Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton x:Name="LikeButton"
                                      VerticalAlignment="Center"
                                      Click="LikeButtonClick"
                                      Background="Transparent"
                                      DataContextChanged="LikeButtonDataContextChanged"
                                      Width="36"
                                      Height="35"
                                      Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}"
                                      Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                      Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel Orientation="Horizontal"
                                    Grid.Column="1"
                                    Margin="2 0" />
                        <Grid Background="Black"
                              Opacity="0"
                              Grid.Column="1"
                              Margin="2 0"
                              VerticalAlignment="Stretch"
                              HorizontalAlignment="Stretch"
                              Tapped="LikedUsersGridTapped" />
                    </Grid>
                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="EmptyStoryShareTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                            <MenuFlyoutItem Text="Copy Text"
                                            DataContext="{Binding}"
                                            Click="CopyTextFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid BorderBrush="#FF252525"
                              MinHeight="50"
                              BorderThickness="1"
                              MaxWidth="360"
                              CornerRadius="25"
                              Margin="5">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Foreground="White"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource DefaultFontSize}"
                                       TextWrapping="Wrap"
                                       TextAlignment="DetectFromContent"
                                       VerticalAlignment="Center"
                                       Margin="15 2"
                                       DataContext="{Binding StoryShare.Title}"
                                       DataContextChanged="TextBlockDataContextChanged" />
                            <TextBlock Foreground="#FFCDCDCD"
                                       Grid.Row="1"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource TinyFontSize}"
                                       TextWrapping="Wrap"
                                       TextAlignment="DetectFromContent"
                                       VerticalAlignment="Center"
                                       Margin="15 2"
                                       DataContext="{Binding StoryShare.Message}"
                                       Text="{Binding}"
                                       DataContextChanged="TextBlockDataContextChanged" />
                            <Grid Grid.Row="2"
                                  HorizontalAlignment="Right">
                                <TextBlock Foreground="#FF858585"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="10.5"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />
                            </Grid>
                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="NoTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                            <MenuFlyoutItem Text="Copy Text"
                                            DataContext="{Binding}"
                                            Click="CopyTextFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid BorderBrush="#FF252525"
                              MinHeight="50"
                              MaxWidth="360"
                              BorderThickness="1"
                              CornerRadius="25"
                              Margin="5">

                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Foreground="#FFCDCDCD"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource TinyFontSize}"
                                       TextWrapping="Wrap"
                                       TextAlignment="DetectFromContent"
                                       VerticalAlignment="Center"
                                       Margin="15 2"
                                       DataContext="{Binding Text}"
                                       DataContextChanged="TextBlockDataContextChanged" />
                            <Grid Grid.Row="1"
                                  HorizontalAlignment="Right">
                                <TextBlock Foreground="#FF858585"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="10.5"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />
                            </Grid>
                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="NotSupportedTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                            <MenuFlyoutItem Text="Copy Text"
                                            DataContext="{Binding}"
                                            Click="CopyTextFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid BorderBrush="#FF252525"
                              Background="#FF1D1C1C"
                              MinHeight="50"
                              BorderThickness="1"
                              MaxWidth="360"
                              CornerRadius="25"
                              Margin="5">
                            <TextBlock Foreground="White"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource DefaultFontSize}"
                                       TextWrapping="Wrap"
                                       TextAlignment="DetectFromContent"
                                       VerticalAlignment="Center"
                                       Margin="15 2"
                                       Text="This type of message is not supported yet" />
                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="PlaceholderTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid BorderBrush="#FF252525"
                              MinHeight="50"
                              BorderThickness="1"
                              MaxWidth="360"
                              CornerRadius="25"
                              Margin="5">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Foreground="White"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource DefaultFontSize}"
                                       TextWrapping="Wrap"
                                       TextAlignment="DetectFromContent"
                                       VerticalAlignment="Center"
                                       Margin="15 2"
                                       DataContext="{Binding Placeholder.Title}"
                                       DataContextChanged="TextBlockDataContextChanged" />
                            <TextBlock Foreground="#FFCDCDCD"
                                       Grid.Row="1"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource TinyFontSize}"
                                       TextWrapping="Wrap"
                                       TextAlignment="DetectFromContent"
                                       VerticalAlignment="Center"
                                       Margin="15 2"
                                       DataContext="{Binding Placeholder.Message}"
                                       DataContextChanged="TextBlockDataContextChanged" />
                            <Grid Grid.Row="2"
                                  HorizontalAlignment="Right">
                                <TextBlock Foreground="#FF858585"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="10.5"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />
                            </Grid>
                        </Grid>
                    </Grid>
                </Grid>

            </DataTemplate>
            <DataTemplate x:Key="TextTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                            <MenuFlyoutItem Text="Copy Text"
                                            DataContext="{Binding}"
                                            Click="CopyTextFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}"
                          Grid.RowSpan="2">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <!--Background="#FF373737"-->

                        <Grid BorderBrush="#FF252525"
                              Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                              MinHeight="60"
                              MinWidth="70"
                              BorderThickness="1"
                              CornerRadius="20"
                              MaxWidth="275"
                              Margin="5">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Foreground="White"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource DefaultFontSize}"
                                       TextWrapping="Wrap"
                                       TextAlignment="DetectFromContent"
                                       VerticalAlignment="Center"
                                       Margin="15 1"
                                       DataContext="{Binding Text}"
                                       DataContextChanged="TextBlockDataContextChanged" />
                            <Grid Grid.Row="1"
                                  HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Foreground="#FF858585"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="10.5"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                                <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Grid.Column="1"
                                           FontFamily="{StaticResource MaterialSymbolFont}"
                                           FontSize="{StaticResource TinyLargeFontSize}"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}"/>
                            </Grid>
                        </Grid>

                    </Grid>
                    <Grid Grid.Column="1"
                          Grid.Row="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          MaxWidth="285"
                          BorderThickness="0"
                          Margin="5 -5 5 5"
                          Visibility="{Binding Reactions.Visibility,Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton x:Name="LikeButton"
                                      VerticalAlignment="Center"
                                      Click="LikeButtonClick"
                                      Background="Transparent"
                                      DataContextChanged="LikeButtonDataContextChanged"
                                      Width="36"
                                      Height="35"
                                      Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}"
                                      Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                      Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel Orientation="Horizontal"
                                    Grid.Column="1"
                                    Margin="2 0" />
                        <Grid Background="Black"
                              Opacity="0"
                              Grid.Column="1"
                              Margin="2 0"
                              VerticalAlignment="Stretch"
                              HorizontalAlignment="Stretch"
                              Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="MediaShareTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                            <MenuFlyoutItem Text="Copy Caption"
                                            DataContext="{Binding}"
                                            Click="CopyTextFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}"
                          Grid.RowSpan="2">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          BorderBrush="#FF252525"
                          Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          MaxWidth="285"
                          BorderThickness="1"
                          CornerRadius="15"
                          Tapped="MediaShareGridTapped"
                          DoubleTapped="MediaShareGridDoubleTapped"
                          Margin="5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid Height="60"
                              Margin="5 0 5 0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" />
                                <ColumnDefinition Width="3" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Ellipse Grid.Column="0"
                                     Height="45"
                                     Width="45"
                                     VerticalAlignment="Center"
                                     HorizontalAlignment="Center"
                                     StrokeThickness="0">
                                <Ellipse.Fill>
                                    <ImageBrush ImageSource="{Binding MediaShare.User.ProfilePicture}" />
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock Foreground="{StaticResource DefaultInnerForegroundColor}"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource TinyFontSize}"
                                       Grid.Column="2"
                                       Text="{Binding MediaShare.User.UserName}"
                                       VerticalAlignment="Center"
                                       Margin="0 8 0 8" />


                        </Grid>
                        <controls:ImageEx Grid.Row="1"
                                          Stretch="Uniform"
                                          MinHeight="90"
                                          Tapped="MediaShareImageExTapped">
                            <controls:ImageEx.Source>
                                <BitmapImage UriSource="{Binding MediaShare, Converter={StaticResource DirectMediaShareConverter}}" />
                            </controls:ImageEx.Source>
                        </controls:ImageEx>
                        <Grid MaxHeight="65"
                              Grid.Row="2">
                            <TextBlock Foreground="{StaticResource DefaultInnerForegroundColor}"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource TinyFontSize}"
                                       Grid.Column="2"
                                       DataContext="{Binding MediaShare.Caption.Text}"
                                       DataContextChanged="TextBlockDataContextChanged"
                                       Margin="5 2" />
                        </Grid>
                        <Grid Grid.Row="3"
                              HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Foreground="#FF858585"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="10.5"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                            <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Grid.Column="1"
                                       FontFamily="{StaticResource MaterialSymbolFont}"
                                       FontSize="{StaticResource TinyLargeFontSize}"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>

                    </Grid>
                    <Grid Grid.Column="1"
                          Grid.Row="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          MaxWidth="285"
                          BorderThickness="0"
                          Margin="5 -5 5 5"
                          Visibility="{Binding Reactions.Visibility,Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton x:Name="LikeButton"
                                      VerticalAlignment="Center"
                                      Background="Transparent"
                                      Click="LikeButtonClick"
                                      DataContextChanged="LikeButtonDataContextChanged"
                                      Width="36"
                                      Height="35"
                                      Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}"
                                      Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                      Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel Orientation="Horizontal"
                                    Grid.Column="1"
                                    Margin="2 0" />
                        <Grid Background="Black"
                              Opacity="0"
                              Grid.Column="1"
                              Margin="2 0"
                              VerticalAlignment="Stretch"
                              HorizontalAlignment="Stretch"
                              Tapped="LikedUsersGridTapped" />
                        <!--<ListView x:Name="LVReactionUsers"
                                  SelectionMode="None"
                                  Foreground="White"
                                  Grid.Column="1"
                                  Margin="0"
                                  ScrollViewer.HorizontalScrollMode="Enabled"
                                  ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                  ScrollViewer.VerticalScrollMode="Disabled"
                                  ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                  IsItemClickEnabled="True">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="HorizontalContentAlignment"
                                            Value="Center" />
                                    <Setter Property="HorizontalAlignment"
                                            Value="Center" />
                                    <Setter Property="Margin"
                                            Value="0" />
                                    <Setter Property="Padding"
                                            Value="0" />
                                    <Setter Property="Width"
                                            Value="34" />
                                    <Setter Property="Height"
                                            Value="34" />
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <ItemsStackPanel Orientation="Horizontal" />
                                </ItemsPanelTemplate>
                            </ListView.ItemsPanel>
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Width="34">
                                        <Ellipse Height="30"
                                                 Width="30">
                                            <Ellipse.Fill>
                                                <ImageBrush>
                                                    <ImageBrush.ImageSource>
                                                        <BitmapImage UriSource="{Binding User.ProfilePicture}" />
                                                    </ImageBrush.ImageSource>
                                                </ImageBrush>
                                            </Ellipse.Fill>
                                        </Ellipse>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>

                        </ListView>-->

                    </Grid>
                </Grid>

            </DataTemplate>
            <DataTemplate x:Key="MediaTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}"
                          Grid.RowSpan="2">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <!--Height="400"
                          Width="290"-->
                    <Grid Grid.Column="1"
                          MaxWidth="290"
                          BorderBrush="#FF252525"
                          Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          BorderThickness="1"
                          CornerRadius="15"
                          Margin="5">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <controls:ImageEx Stretch="Uniform"
                                          MinHeight="90">
                            <controls:ImageEx.Source>
                                <BitmapImage UriSource="{Binding Media.Images[0].Uri}" />
                            </controls:ImageEx.Source>
                        </controls:ImageEx>
                        <ProgressBar RenderTransformOrigin="0.5,0.5"
                                     Maximum="100"
                                     Value="{Binding Media.Percentage}"
                                     Visibility="{Binding Media.Percentage, Converter={StaticResource DoubleToVisibilityConverter}}"
                                     VerticalAlignment="Stretch"
                                     HorizontalAlignment="Stretch"
                                     Foreground="#B6292828"
                                     Background="#4DFFFFFF">
                            <ProgressBar.RenderTransform>
                                <CompositeTransform Rotation="-90" />
                            </ProgressBar.RenderTransform>
                        </ProgressBar>
                        <ProgressRing Height="85"
                                      Width="85"
                                      IsActive="True"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Center"
                                      Visibility="{Binding Media.Percentage, Converter={StaticResource DoubleToVisibilityConverter}}"
                                      Foreground="#D8575757" />

                        <Grid Grid.Row="1"
                              HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Foreground="#FF858585"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="10.5"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                            <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Grid.Column="1"
                                       FontFamily="{StaticResource MaterialSymbolFont}"
                                       FontSize="{StaticResource TinyLargeFontSize}"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>

                        <Grid Background="DodgerBlue"
                              Grid.RowSpan="2"
                              Opacity="0"
                              Tapped="MediaImageExTapped" />
                    </Grid>
                    <Grid Grid.Column="1"
                          Grid.Row="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          MaxWidth="285"
                          BorderThickness="0"
                          Margin="5 -5 5 0"
                          Visibility="{Binding Reactions.Visibility,Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton x:Name="LikeButton"
                                      VerticalAlignment="Center"
                                      Click="LikeButtonClick"
                                      Background="Transparent"
                                      DataContextChanged="LikeButtonDataContextChanged"
                                      Width="36"
                                      Height="35"
                                      Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}"
                                      Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                      Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel Orientation="Horizontal"
                                    Margin="2 0"
                                    Grid.Column="1" />
                        <Grid Background="Black"
                              Opacity="0"
                              Grid.Column="1"
                              Margin="2 0"
                              VerticalAlignment="Stretch"
                              HorizontalAlignment="Stretch"
                              Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="ProfileTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                            <MenuFlyoutItem Text="Copy Profile"
                                            DataContext="{Binding}"
                                            Click="CopyTextFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}"
                          Grid.RowSpan="2">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          BorderBrush="#FF252525"
                          Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                          Width="205.5"
                          MaxHeight="182"
                          BorderThickness="1"
                          CornerRadius="15"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          Margin="5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid Height="60"
                              Margin="5 0 5 0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" />
                                <ColumnDefinition Width="3" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Ellipse Grid.Column="0"
                                     Height="45"
                                     Width="45"
                                     VerticalAlignment="Center"
                                     HorizontalAlignment="Center"
                                     StrokeThickness="0">
                                <Ellipse.Fill>
                                    <ImageBrush ImageSource="{Binding ProfileMedia.ProfilePicture}" />
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock Foreground="{StaticResource DefaultInnerForegroundColor}"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource TinyFontSize}"
                                       Grid.Column="2"
                                       Text="{Binding ProfileMedia.UserName}"
                                       VerticalAlignment="Center"
                                       Margin="0 8 0 8" />


                        </Grid>
                        <GridView Grid.Row="1"
                                  SelectionMode="None"
                                  IsItemClickEnabled="False"
                                  ItemsSource="{Binding PreviewMedias}"
                                  ItemTemplate="{StaticResource ProfileGridViewTemplate}"
                                  ItemContainerStyle="{StaticResource GridViewItemContainerStyle}"
                                  ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                  ScrollViewer.VerticalScrollMode="Disabled"
                                  ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                  ScrollViewer.HorizontalScrollMode="Disabled">
                            <GridView.ItemContainerTransitions>
                                <TransitionCollection>
                                    <EntranceThemeTransition />
                                </TransitionCollection>
                            </GridView.ItemContainerTransitions>

                        </GridView>
                        <Grid Grid.Row="2"
                              HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Foreground="#FF858585"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="10.5"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                            <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Grid.Column="1"
                                       FontFamily="{StaticResource MaterialSymbolFont}"
                                       FontSize="{StaticResource TinyLargeFontSize}"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>

                        <Grid Background="AliceBlue"
                              Opacity="0"
                              Grid.RowSpan="3"
                              Tapped="ProfileGridTapped" />
                    </Grid>
                    <Grid Grid.Column="1"
                          Grid.Row="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          MaxWidth="285"
                          BorderThickness="0"
                          Margin="5 -5 5 5"
                          Visibility="{Binding Reactions.Visibility,Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton x:Name="LikeButton"
                                      VerticalAlignment="Center"
                                      Click="LikeButtonClick"
                                      Background="Transparent"
                                      DataContextChanged="LikeButtonDataContextChanged"
                                      Width="36"
                                      Height="35"
                                      Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}"
                                      Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                      Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel Orientation="Horizontal"
                                    Grid.Column="1"
                                    Margin="2 0" />
                        <Grid Background="Black"
                              Opacity="0"
                              Grid.Column="1"
                              Margin="2 0"
                              VerticalAlignment="Stretch"
                              HorizontalAlignment="Stretch"
                              Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="FelixShareTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                            <MenuFlyoutItem Text="Copy Caption"
                                            DataContext="{Binding}"
                                            Click="CopyTextFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}"
                          Grid.RowSpan="2">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid BorderBrush="#FF252525"
                              BorderThickness="1"
                              MaxWidth="300"
                              CornerRadius="25"
                              Margin="5">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <controls:ImageEx 
                                              Stretch="Uniform"
                                              MinHeight="90">
                                <controls:ImageEx.Source>
                                    <BitmapImage UriSource="{Binding FelixShareMedia.Images[0].Uri}" />
                                </controls:ImageEx.Source>
                            </controls:ImageEx>
                            <Grid VerticalAlignment="Bottom">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"
                                                   MaxHeight="75" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <controls:DropShadowPanel BlurRadius="15.0"
                                                          ShadowOpacity="0.70"
                                                          OffsetX="5.0"
                                                          OffsetY="5.0"
                                                          Color="Black"
                                                          Margin="15 2">
                                    <TextBlock Foreground="White"
                                               FontFamily="{StaticResource VazirFont}"
                                               FontSize="{StaticResource TinyFontSize}"
                                               TextWrapping="Wrap"
                                               TextAlignment="DetectFromContent"
                                               VerticalAlignment="Center"
                                               Text="{Binding FelixShareMedia.Title}" />

                                </controls:DropShadowPanel>


                                <Grid Height="60"
                                      Grid.Row="1"
                                      Margin="5 0 5 0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="50" />
                                        <ColumnDefinition Width="3" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Ellipse Grid.Column="0"
                                             Height="45"
                                             Width="45"
                                             VerticalAlignment="Center"
                                             HorizontalAlignment="Center"
                                             StrokeThickness="0">
                                        <Ellipse.Fill>
                                            <ImageBrush ImageSource="{Binding FelixShareMedia.User.ProfilePicture}" />
                                        </Ellipse.Fill>
                                    </Ellipse>
                                    <controls:DropShadowPanel BlurRadius="15.0"
                                                              ShadowOpacity="0.70"
                                                              OffsetX="5.0"
                                                              OffsetY="5.0"
                                                              Color="Black"
                                                              Grid.Column="2">
                                        <TextBlock Foreground="White"
                                                   FontFamily="{StaticResource VazirFont}"
                                                   FontSize="{StaticResource TinyFontSize}"
                                                   Text="{Binding FelixShareMedia.User.UserName}"
                                                   VerticalAlignment="Center"
                                                   Margin="0 8 0 8" />
                                    </controls:DropShadowPanel>

                                </Grid>

                            </Grid>
                            <Grid Grid.Row="1"
                                  HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Foreground="#FF858585"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="10.5"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                                <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Grid.Column="1"
                                           FontFamily="{StaticResource MaterialSymbolFont}"
                                           FontSize="{StaticResource TinyLargeFontSize}"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>

                            <Grid Background="AliceBlue"
                                  Opacity="0"
                                  Grid.RowSpan="4"
                                  Tapped="FelixShareGridTapped" />
                        </Grid>

                    </Grid>
                    <Grid Grid.Column="1"
                          Grid.Row="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          MaxWidth="285"
                          BorderThickness="0"
                          Margin="5 -5 5 5"
                          Visibility="{Binding Reactions.Visibility,Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton x:Name="LikeButton"
                                      VerticalAlignment="Center"
                                      Click="LikeButtonClick"
                                      Background="Transparent"
                                      DataContextChanged="LikeButtonDataContextChanged"
                                      Width="36"
                                      Height="35"
                                      Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}"
                                      Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                      Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel Orientation="Horizontal"
                                    Grid.Column="1"
                                    Margin="2 0" />
                        <Grid Background="Black"
                              Opacity="0"
                              Grid.Column="1"
                              Margin="2 0"
                              VerticalAlignment="Stretch"
                              HorizontalAlignment="Stretch"
                              Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="RavenMediaTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}"
                          Grid.RowSpan="2">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid BorderBrush="#FF252525"
                              Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                              MinHeight="45"
                              BorderThickness="1.5"
                              CornerRadius="25"
                              MaxWidth="360"
                              Margin="5">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Foreground="White"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource DefaultFontSize}"
                                       TextWrapping="Wrap"
                                       TextAlignment="DetectFromContent"
                                       VerticalAlignment="Center"
                                       Margin="12 2">
                            <Run FontFamily="{StaticResource MaterialSymbolFont}"
                                 Text=""
                                 FontSize="{StaticResource BigFontSize}" />
                            <Run Text="{Binding VisualMedia.Media.MediaType, Converter={StaticResource MediaTypeConverter}}" />
                            </TextBlock>
                            <Grid Grid.Row="1"
                                  HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Foreground="#FF858585"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="10.5"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                                <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Grid.Column="1"
                                           FontFamily="{StaticResource MaterialSymbolFont}"
                                           FontSize="{StaticResource TinyLargeFontSize}"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>

                            <Grid Background="LemonChiffon"
                                  Opacity="0"
                                  Tapped="VisualMediaTapped" />
                        </Grid>

                    </Grid>
                    <Grid Grid.Column="1"
                          Grid.Row="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          MaxWidth="285"
                          BorderThickness="0"
                          Margin="5 -5 5 5"
                          Visibility="{Binding Reactions.Visibility,Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton x:Name="LikeButton"
                                      VerticalAlignment="Center"
                                      Click="LikeButtonClick"
                                      Background="Transparent"
                                      DataContextChanged="LikeButtonDataContextChanged"
                                      Width="36"
                                      Height="35"
                                      Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}"
                                      Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                      Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel Orientation="Horizontal"
                                    Grid.Column="1"
                                    Margin="2 0" />
                        <Grid Background="Black"
                              Opacity="0"
                              Grid.Column="1"
                              Margin="2 0"
                              VerticalAlignment="Stretch"
                              HorizontalAlignment="Stretch"
                              Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="LocationMediaTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                            <MenuFlyoutItem Text="Copy Location"
                                            DataContext="{Binding}"
                                            Click="CopyTextFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}"
                          Grid.RowSpan="2">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          BorderBrush="#FF252525"
                          Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                          Width="205.5"
                          MaxHeight="168"
                          BorderThickness="1"
                          CornerRadius="15"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          Margin="5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid Height="45"
                              Margin="5 0 5 0">
                            <TextBlock Foreground="{StaticResource DefaultInnerForegroundColor}"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource DefaultFontSize}"
                                       DataContext="{Binding LocationMedia.Name}"
                                       DataContextChanged="TextBlockDataContextChanged"
                                       VerticalAlignment="Center"
                                       Margin="0 8 0 8" />


                        </Grid>
                        <GridView Grid.Row="1"
                                  SelectionMode="None"
                                  IsItemClickEnabled="False"
                                  ItemsSource="{Binding PreviewMedias}"
                                  ItemTemplate="{StaticResource ProfileGridViewTemplate}"
                                  ItemContainerStyle="{StaticResource GridViewItemContainerStyle}"
                                  ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                  ScrollViewer.VerticalScrollMode="Disabled"
                                  ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                  ScrollViewer.HorizontalScrollMode="Disabled">
                            <GridView.ItemContainerTransitions>
                                <TransitionCollection>
                                    <EntranceThemeTransition />
                                </TransitionCollection>
                            </GridView.ItemContainerTransitions>

                        </GridView>
                        <Grid Grid.Row="2"
                              HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Foreground="#FF858585"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="10.5"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                            <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Grid.Column="1"
                                       FontFamily="{StaticResource MaterialSymbolFont}"
                                       FontSize="{StaticResource TinyLargeFontSize}"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>

                        <Grid Background="AliceBlue"
                              Opacity="0"
                              Grid.RowSpan="3"
                              Tapped="ProfileGridTapped" />
                    </Grid>
                    <Grid Grid.Column="1"
                          Grid.Row="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          MaxWidth="285"
                          BorderThickness="0"
                          Margin="5 -5 5 5"
                          Visibility="{Binding Reactions.Visibility,Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton x:Name="LikeButton"
                                      VerticalAlignment="Center"
                                      Click="LikeButtonClick"
                                      Background="Transparent"
                                      DataContextChanged="LikeButtonDataContextChanged"
                                      Width="36"
                                      Height="35"
                                      Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}"
                                      Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                      Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel Orientation="Horizontal"
                                    Grid.Column="1"
                                    Margin="2 0" />
                        <Grid Background="Black"
                              Opacity="0"
                              Grid.Column="1"
                              Margin="2 0"
                              VerticalAlignment="Stretch"
                              HorizontalAlignment="Stretch"
                              Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="ReelShareMediaTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                            <MenuFlyoutItem Text="Copy Text"
                                            DataContext="{Binding}"
                                            Click="CopyTextFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}"
                          Grid.RowSpan="2">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Foreground="White"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource TinyFontSize}"
                                       TextWrapping="Wrap"
                                       TextAlignment="DetectFromContent"
                                       VerticalAlignment="Center"
                                       Margin="5 2"
                                       DataContext="{Binding Converter={StaticResource ReelShareConverter}}"
                                       DataContextChanged="TextBlockDataContextChanged" />
                            <Grid BorderBrush="#FF252525"
                                  MinHeight="50"
                                  Grid.Row="1"
                                  BorderThickness="1"
                                  MinWidth="240"
                                  MaxWidth="320"
                                  MaxHeight="360"
                                  CornerRadius="25"
                                  Margin="5">

                                <controls:ImageEx Grid.Row="1"
                                                  Stretch="Uniform"
                                                  MinHeight="300"
                                                  Tapped="ReelShareImageExTapped">
                                    <controls:ImageEx.Source>
                                        <BitmapImage UriSource="{Binding ReelShareMedia.Media.Images[0].Uri}" />
                                    </controls:ImageEx.Source>
                                </controls:ImageEx>
                            </Grid>
                            <Grid BorderBrush="#FF252525"
                                  Background="#FF1D1C1C"
                                  MinHeight="50"
                                  Grid.Row="2"
                                  BorderThickness="1"
                                  CornerRadius="25"
                                  MaxWidth="320"
                                  Margin="5"
                                  HorizontalAlignment="Left"
                                  Visibility="{Binding ReelShareMedia.Text,Converter={StaticResource NullableToVisibilityConverter}}">
                                <TextBlock Foreground="White"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="{StaticResource DefaultFontSize}"
                                           TextWrapping="Wrap"
                                           TextAlignment="DetectFromContent"
                                           VerticalAlignment="Center"
                                           Margin="15 2"
                                           DataContext="{Binding ReelShareMedia.Text}"
                                           DataContextChanged="TextBlockDataContextChanged" />
                            </Grid>
                            <Grid Grid.Row="3"
                                  HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Foreground="#FF858585"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="10.5"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                                <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Grid.Column="1"
                                           FontFamily="{StaticResource MaterialSymbolFont}"
                                           FontSize="{StaticResource TinyLargeFontSize}"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>

                        </Grid>
                    </Grid>
                    <Grid Grid.Column="1"
                          Grid.Row="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          MaxWidth="285"
                          BorderThickness="0"
                          Margin="5 -5 5 5"
                          Visibility="{Binding Reactions.Visibility,Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton x:Name="LikeButton"
                                      VerticalAlignment="Center"
                                      Click="LikeButtonClick"
                                      Background="Transparent"
                                      DataContextChanged="LikeButtonDataContextChanged"
                                      Width="36"
                                      Height="35"
                                      Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}"
                                      Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                      Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel Orientation="Horizontal"
                                    Grid.Column="1"
                                    Margin="2 0" />
                        <Grid Background="Black"
                              Opacity="0"
                              Grid.Column="1"
                              Margin="2 0"
                              VerticalAlignment="Stretch"
                              HorizontalAlignment="Stretch"
                              Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="EmptyReelShareMediaTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid MaxWidth="360">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Foreground="White"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource TinyFontSize}"
                                       TextWrapping="Wrap"
                                       TextAlignment="DetectFromContent"
                                       VerticalAlignment="Center"
                                       Margin="5 2"
                                       DataContext="{Binding Converter={StaticResource ReelShareConverter}}"
                                       DataContextChanged="TextBlockDataContextChanged" />
                            <Grid BorderBrush="#FF252525"
                                  Background="#FF1D1C1C"
                                  Grid.Row="1"
                                  MinHeight="45"
                                  BorderThickness="1"
                                  CornerRadius="25"
                                  MaxWidth="360"
                                  Margin="5"
                                  Visibility="{Binding Converter={StaticResource NullableToVisibilityConverter}}">
                                <TextBlock Foreground="White"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="{StaticResource DefaultFontSize}"
                                           TextWrapping="Wrap"
                                           TextAlignment="DetectFromContent"
                                           VerticalAlignment="Center"
                                           Margin="15 2"
                                           Text="{Binding ReelShareMedia.Text}" />
                            </Grid>
                            <Grid Grid.Row="2"
                                  HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Foreground="#FF858585"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="10.5"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                                <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Grid.Column="1"
                                           FontFamily="{StaticResource MaterialSymbolFont}"
                                           FontSize="{StaticResource TinyLargeFontSize}"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>

                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>


            <DataTemplate x:Key="HashtagMediaTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                            <MenuFlyoutItem Text="Copy Hashtag"
                                            DataContext="{Binding}"
                                            Click="CopyTextFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}"
                          Grid.RowSpan="2">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          BorderBrush="#FF252525"
                          Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                          Width="205.5"
                          MaxHeight="168"
                          BorderThickness="1"
                          CornerRadius="15"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          Margin="5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid Height="45"
                              Margin="5 0 5 0">
                            <TextBlock Foreground="{StaticResource DefaultInnerForegroundColor}"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource DefaultFontSize}"
                                       VerticalAlignment="Center"
                                       Margin="0 8 0 8"
                                       Text="{Binding HashtagMedia.Name, Converter={StaticResource AddHashtagToStringConverter}}" />
                        </Grid>
                        <GridView Grid.Row="1"
                                  SelectionMode="None"
                                  IsItemClickEnabled="False"
                                  ItemsSource="{Binding PreviewMedias}"
                                  ItemTemplate="{StaticResource ProfileGridViewTemplate}"
                                  ItemContainerStyle="{StaticResource GridViewItemContainerStyle}"
                                  ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                  ScrollViewer.VerticalScrollMode="Disabled"
                                  ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                  ScrollViewer.HorizontalScrollMode="Disabled">
                            <GridView.ItemContainerTransitions>
                                <TransitionCollection>
                                    <EntranceThemeTransition />
                                </TransitionCollection>
                            </GridView.ItemContainerTransitions>

                        </GridView>
                        <Grid Grid.Row="2"
                              HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Foreground="#FF858585"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="10.5"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                            <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Grid.Column="1"
                                       FontFamily="{StaticResource MaterialSymbolFont}"
                                       FontSize="{StaticResource TinyLargeFontSize}"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>

                        <Grid Background="AliceBlue"
                              Opacity="0"
                              Grid.RowSpan="3"
                              Tapped="ProfileGridTapped" />
                    </Grid>
                    <Grid Grid.Column="1"
                          Grid.Row="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          MaxWidth="285"
                          BorderThickness="0"
                          Margin="5 -5 5 5"
                          Visibility="{Binding Reactions.Visibility,Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton x:Name="LikeButton"
                                      VerticalAlignment="Center"
                                      Click="LikeButtonClick"
                                      Background="Transparent"
                                      DataContextChanged="LikeButtonDataContextChanged"
                                      Width="36"
                                      Height="35"
                                      Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}"
                                      Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                      Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel Orientation="Horizontal"
                                    Grid.Column="1"
                                    Margin="2 0" />
                        <Grid Background="Black"
                              Opacity="0"
                              Grid.Column="1"
                              Margin="2 0"
                              VerticalAlignment="Stretch"
                              HorizontalAlignment="Stretch"
                              Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>


            <DataTemplate x:Key="VoiceMediaTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}"
                          Grid.RowSpan="2">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          BorderBrush="#FF252525"
                          Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                          MinWidth="80"
                          MaxHeight="75"
                          BorderThickness="1"
                          CornerRadius="15"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          Margin="5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid Height="42"
                              Margin="5 0 5 0"
                              DataContext="{Binding}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <ToggleButton x:Name="PlayPauseButton"
                                          Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                          Background="Transparent"
                                          Height="40"
                                          Width="40"
                                          Tag=""
                                          VerticalAlignment="Center"
                                          FontSize="{StaticResource DefaultFontSize}"
                                          FontFamily="{StaticResource VazirFont}"
                                          Margin="0 0 2 0"
                                          Click="PlayPauseButtonClick" />
                            <!--<AppBarButton x:Name="PlayPauseButton"
                                          Foreground="{StaticResource DefaultForegroundColor}"
                                          Content=""
                                          Tag="{Binding ItemId}"
                                          VerticalAlignment="Center"
                                          FontFamily="{StaticResource MaterialSymbolFont}"
                                          FontSize="{StaticResource BigBigFontSize}"
                                          Click="PlayPauseButtonClick" />-->
                            <!--<Grid Grid.Column="1"
                                  DataContext="{Binding}"
                                  Height="60"
                                  MaxWidth="160"
                                  MinWidth="70"
                                  DataContextChanged="VoiceMediaGridDataContextChanged">

                            </Grid>-->
                            <ministaUc:ProgressVoice x:Name="ProgressVoice"
                                                     Grid.Column="1"
                                                     DataContext="{Binding}"
                                                     VerticalAlignment="Center"
                                                     Foreground="#FF007ACC"
                                                     HorizontalAlignment="Stretch"
                                                     DataContextChanged="ProgressVoiceDataContextChanged" />

                        </Grid>
                        <Grid Grid.Row="2"
                              HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Foreground="#FF858585"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="10.5"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                            <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Grid.Column="1"
                                       FontFamily="{StaticResource MaterialSymbolFont}"
                                       FontSize="{StaticResource TinyLargeFontSize}"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>

                    </Grid>
                    <Grid Grid.Column="1"
                          Grid.Row="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          MaxWidth="285"
                          BorderThickness="0"
                          Margin="5 -5 5 5"
                          Visibility="{Binding Reactions.Visibility,Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton x:Name="LikeButton"
                                      VerticalAlignment="Center"
                                      Click="LikeButtonClick"
                                      Background="Transparent"
                                      DataContextChanged="LikeButtonDataContextChanged"
                                      Width="36"
                                      Height="35"
                                      Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}"
                                      Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                      Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel Orientation="Horizontal"
                                    Grid.Column="1"
                                    Margin="2 0" />
                        <Grid Background="Black"
                              Opacity="0"
                              Grid.Column="1"
                              Margin="2 0"
                              VerticalAlignment="Stretch"
                              HorizontalAlignment="Stretch"
                              Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="LinkMediaTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                            <MenuFlyoutItem Text="Copy Url"
                                            DataContext="{Binding}"
                                            Click="CopyTextFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid BorderBrush="#FF252525"
                              Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                              MinHeight="50"
                              BorderThickness="1"
                              CornerRadius="25"
                              MaxWidth="360"
                              MinWidth="210"
                              Margin="5">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Foreground="White"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource DefaultFontSize}"
                                       TextWrapping="Wrap"
                                       TextAlignment="DetectFromContent"
                                       VerticalAlignment="Center"
                                       Margin="15 2"
                                       DataContext="{Binding LinkMedia.Text}"
                                       DataContextChanged="TextBlockDataContextChanged" />
                            <Grid Grid.Row="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Rectangle Height="1"
                                           Fill="#FF252525" />
                                <controls:ImageEx HorizontalAlignment="Stretch"
                                                  VerticalAlignment="Stretch"
                                                  Height="155"
                                                  Grid.Row="1"
                                                  Visibility="{Binding LinkMedia.LinkContext.LinkImageUrl, Converter={StaticResource NullableToVisibilityConverter}}">
                                    <controls:ImageEx.Background>
                                        <ImageBrush Stretch="Fill">
                                            <ImageBrush.ImageSource>
                                                <BitmapImage UriSource="{Binding LinkMedia.LinkContext.LinkImageUrl}" />
                                            </ImageBrush.ImageSource>
                                        </ImageBrush>
                                    </controls:ImageEx.Background>
                                </controls:ImageEx>
                                <TextBlock Foreground="White"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="{StaticResource DefaultFontSize}"
                                           TextWrapping="Wrap"
                                           TextAlignment="DetectFromContent"
                                           VerticalAlignment="Center"
                                           Margin="18 2"
                                           Grid.Row="2"
                                           DataContext="{Binding LinkMedia.LinkContext.LinkTitle}"
                                           DataContextChanged="TextBlockDataContextChanged"
                                           Visibility="{Binding Converter={StaticResource NullableToVisibilityConverter}}" />
                                <TextBlock Foreground="#FFA6A6A6"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="{StaticResource TinyFontSize}"
                                           TextWrapping="Wrap"
                                           TextAlignment="DetectFromContent"
                                           VerticalAlignment="Center"
                                           Margin="18 2"
                                           Grid.Row="3"
                                           DataContext="{Binding LinkMedia.LinkContext.LinkSummary}"
                                           DataContextChanged="TextBlockDataContextChanged"
                                           Visibility="{Binding Converter={StaticResource NullableToVisibilityConverter}}" />
                                <TextBlock Foreground="#FFA6A6A6"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="{StaticResource TinyFontSize}"
                                           TextWrapping="Wrap"
                                           TextAlignment="DetectFromContent"
                                           VerticalAlignment="Center"
                                           Margin="18 2"
                                           Grid.Row="4"
                                           DataContext="{Binding LinkMedia.LinkContext.LinkUrl}"
                                           DataContextChanged="TextBlockDataContextChanged"
                                           Visibility="{Binding Converter={StaticResource NullableToVisibilityConverter}}" />
                            </Grid>
                            <Grid Grid.Row="2"
                                  HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Foreground="#FF858585"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="10.5"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                                <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Grid.Column="1"
                                           FontFamily="{StaticResource MaterialSymbolFont}"
                                           FontSize="{StaticResource TinyLargeFontSize}"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                           Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>

                            <Grid Background="AliceBlue"
                                  Opacity="0"
                                  Grid.RowSpan="3"
                                  Tapped="LinkMediaGridTapped" />
                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>


            <DataTemplate x:Key="LiveViewerInviteTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}"
                          Grid.RowSpan="2">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid MaxWidth="340">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Rectangle Fill="#FF252525"
                                       Width="2"
                                       HorizontalAlignment="Stretch"
                                       VerticalAlignment="Stretch" />
                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <TextBlock Foreground="White"
                                               FontFamily="{StaticResource VazirFont}"
                                               FontSize="{StaticResource TinyFontSize}"
                                               TextWrapping="Wrap"
                                               TextAlignment="DetectFromContent"
                                               VerticalAlignment="Center"
                                               Margin="5 2"
                                               DataContext="{Binding LiveViewerInvite.Title}"
                                               DataContextChanged="TextBlockDataContextChanged" />
                                    <TextBlock Foreground="White"
                                               FontFamily="{StaticResource VazirFont}"
                                               FontSize="{StaticResource TinyFontSize}"
                                               TextWrapping="Wrap"
                                               TextAlignment="DetectFromContent"
                                               VerticalAlignment="Center"
                                               Margin="5 2"
                                               Grid.Row="1"
                                               DataContext="{Binding LiveViewerInvite.Message}"
                                               DataContextChanged="TextBlockDataContextChanged" />
                                </Grid>

                                <Grid BorderBrush="#FF252525"
                                      MinHeight="50"
                                      Grid.Row="1"
                                      BorderThickness="1"
                                      MaxWidth="340"
                                      MinWidth="240"
                                      Height="360"
                                      CornerRadius="25"
                                      Margin="5"
                                      Visibility="{Binding LiveViewerInvite.Broadcast, Converter={StaticResource NullableToVisibilityConverter}}">
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid>
                                        <controls:ImageEx HorizontalAlignment="Stretch"
                                                          VerticalAlignment="Stretch">
                                            <controls:ImageEx.Background>
                                                <ImageBrush Stretch="Fill">
                                                    <ImageBrush.ImageSource>
                                                        <BitmapImage UriSource="{Binding LiveViewerInvite.Broadcast.CoverFrameUrl}" />
                                                    </ImageBrush.ImageSource>
                                                </ImageBrush>
                                            </controls:ImageEx.Background>
                                        </controls:ImageEx>
                                        <Grid Height="60"
                                              Margin="5 0 5 0"
                                              VerticalAlignment="Top">
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="50" />
                                                <ColumnDefinition Width="3" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <Ellipse Grid.Column="0"
                                                     Height="45"
                                                     Width="45"
                                                     VerticalAlignment="Center"
                                                     HorizontalAlignment="Center"
                                                     StrokeThickness="0">
                                                <Ellipse.Fill>
                                                    <ImageBrush ImageSource="{Binding LiveViewerInvite.Broadcast.BroadcastOwner.ProfilePicture}" />
                                                </Ellipse.Fill>
                                            </Ellipse>
                                            <TextBlock Foreground="{StaticResource DefaultInnerForegroundColor}"
                                                       FontFamily="{StaticResource VazirFont}"
                                                       FontSize="{StaticResource TinyFontSize}"
                                                       Grid.Column="2"
                                                       Text="{Binding LiveViewerInvite.Broadcast.BroadcastOwner.UserName}"
                                                       VerticalAlignment="Center"
                                                       Margin="0 8 0 8" />

                                            <Grid Grid.Column="3"
                                                  CornerRadius="5"
                                                  VerticalAlignment="Center">
                                                <Grid.Background>
                                                    <LinearGradientBrush EndPoint="0.5,1"
                                                                         StartPoint="0.5,0">
                                                        <GradientStop Color="#FFC80082" />
                                                        <GradientStop Color="#FFDF0041"
                                                                      Offset="1" />
                                                    </LinearGradientBrush>
                                                </Grid.Background>
                                                <TextBlock Foreground="White"
                                                           FontFamily="{StaticResource VazirFont}"
                                                           FontSize="{StaticResource TinyFontSize}"
                                                           Grid.Column="2"
                                                           Text="LIVE"
                                                           VerticalAlignment="Center"
                                                           Margin="4 2" />
                                            </Grid>
                                            <Grid Grid.Column="3"
                                                  CornerRadius="5"
                                                  Grid.Row="1"
                                                  VerticalAlignment="Center">
                                                <Grid.Background>
                                                    <LinearGradientBrush EndPoint="0.5,1"
                                                                         StartPoint="0.5,0">
                                                        <GradientStop Color="#FFC80082" />
                                                        <GradientStop Color="#FFDF0041"
                                                                      Offset="1" />
                                                    </LinearGradientBrush>
                                                </Grid.Background>
                                                <!--<TextBlock Foreground="White"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="{StaticResource TinyFontSize}"
                                           Grid.Column="2"
                                           VerticalAlignment="Center"
                                           Margin="4 2">
                                    <Run FontFamily="{StaticResource SymbolFont}"
                                         FontSize="{StaticResource TinyFontSize}"
                                         Text="" />
                                </TextBlock>-->

                                            </Grid>
                                        </Grid>

                                    </Grid>
                                    <TextBlock Foreground="White"
                                               FontFamily="{StaticResource VazirFont}"
                                               FontSize="{StaticResource DefaultFontSize}"
                                               TextWrapping="Wrap"
                                               TextAlignment="DetectFromContent"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Center"
                                               Margin="6"
                                               Grid.Row="1"
                                               Text="Watch Live Video" />
                                </Grid>
                                <Grid Grid.Row="2"
                                      HorizontalAlignment="Right">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Foreground="#FF858585"
                                               FontFamily="{StaticResource VazirFont}"
                                               FontSize="10.5"
                                               TextWrapping="NoWrap"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Right"
                                               Margin="0 0 10 5"
                                               Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                                    <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                               Grid.Column="1"
                                               FontFamily="{StaticResource MaterialSymbolFont}"
                                               FontSize="{StaticResource TinyLargeFontSize}"
                                               TextWrapping="NoWrap"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Right"
                                               Margin="0 0 10 5"
                                               Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                               Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                                </Grid>

                            </Grid>
                        </Grid>

                    </Grid>
                    <Grid Grid.Column="1"
                          Grid.Row="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          MaxWidth="285"
                          BorderThickness="0"
                          Margin="5"
                          Visibility="{Binding Reactions.Visibility,Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton x:Name="LikeButton"
                                      VerticalAlignment="Center"
                                      Click="LikeButtonClick"
                                      Background="Transparent"
                                      DataContextChanged="LikeButtonDataContextChanged"
                                      Width="40"
                                      Height="40"
                                      Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}"
                                      Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                      Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel Orientation="Horizontal"
                                    Grid.Column="1" />
                    </Grid>

                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="VideoCallEventTemplate">
                <Grid HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid MinHeight="50"
                          MaxWidth="360"
                          Margin="5">

                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <TextBlock Foreground="#FFCDCDCD"
                                   FontFamily="{StaticResource VazirFont}"
                                   FontSize="{StaticResource TinyFontSize}"
                                   TextWrapping="Wrap"
                                   TextAlignment="DetectFromContent"
                                   VerticalAlignment="Center"
                                   Margin="15 2"
                                   DataContext="{Binding VideoCallEvent.Description}"
                                   DataContextChanged="TextBlockDataContextChanged" />
                        <Grid Grid.Row="1"
                              HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Foreground="#FF858585"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="10.5"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                            <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Grid.Column="1"
                                       FontFamily="{StaticResource MaterialSymbolFont}"
                                       FontSize="{StaticResource TinyLargeFontSize}"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="AnimatedMediaTemplate">
                <Grid IsRightTapEnabled="True"
                      IsHoldingEnabled="True"
                      RightTapped="MenuGridRightTapped"
                      Holding="MenuGridHolding">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem Text="Unsend Message"
                                            DataContext="{Binding}"
                                            Click="UnsendMessageFlyoutClick" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}"
                          Grid.RowSpan="2">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid BorderBrush="#FF252525"
                              Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                              MinHeight="185"
                              BorderThickness="1"
                              CornerRadius="25"
                              MaxWidth="390"
                              MinWidth="100"
                              Margin="5"
                              Height="{Binding AnimatedMedia.Media.Height}"
                              Width="{Binding AnimatedMedia.Media.Width}">
                            <!--<controls:ImageEx HorizontalAlignment="Stretch"
                                          VerticalAlignment="Stretch">
                            <controls:ImageEx.Background>
                                <ImageBrush Stretch="Fill">
                                    <ImageBrush.ImageSource>
                                        <BitmapImage UriSource="{Binding AnimatedMedia.Media.Url}"
                                                     ImageOpened="AnimatedMediaImageOpened"/>
                                    </ImageBrush.ImageSource>
                                </ImageBrush>
                            </controls:ImageEx.Background>
                        </controls:ImageEx>-->

                            <!--<Image Grid.Row="0"
                                   Stretch="None"
                                   HorizontalAlignment="Stretch"
                                   VerticalAlignment="Stretch"
                                   gif:AnimationBehavior.AutoStart="True"
                                   gif:AnimationBehavior.RepeatBehavior="Forever"
                                   gif:AnimationBehavior.SourceUri="{Binding AnimatedMedia.Media.Url, Converter={StaticResource StringToUriConverter}}" />-->
                            <MediaElement AutoPlay="False"
                                          Stretch="Uniform"
                                          HorizontalAlignment="Stretch"
                                          VerticalAlignment="Stretch"
                                          AreTransportControlsEnabled="False"
                                          Source="{Binding AnimatedMedia.Media.Mp4Url, Converter={StaticResource StringToUriConverter}}"
                                          Tapped="MediaElementTapped" />

                        </Grid>
                        <Grid Grid.Row="1" Grid.ColumnSpan="2"
                              HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Foreground="#FF858585"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="10.5"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                            <TextBlock Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Grid.Column="1"
                                       FontFamily="{StaticResource MaterialSymbolFont}"
                                       FontSize="{StaticResource TinyLargeFontSize}"
                                       TextWrapping="NoWrap"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0 0 10 5"
                                       Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                       Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>


                    </Grid>
                    <Grid Grid.Column="1"
                          Grid.Row="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                          MaxWidth="285"
                          BorderThickness="0"
                          Margin="5 -5 5 5"
                          Visibility="{Binding Reactions.Visibility,Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton x:Name="LikeButton"
                                      VerticalAlignment="Center"
                                      Click="LikeButtonClick"
                                      Background="Transparent"
                                      DataContextChanged="LikeButtonDataContextChanged"
                                      Width="36"
                                      Height="35"
                                      Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}"
                                      Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                      Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel Orientation="Horizontal"
                                    Grid.Column="1"
                                    Margin="2 0" />
                        <Grid Background="Black"
                              Opacity="0"
                              Grid.Column="1"
                              Margin="2 0"
                              VerticalAlignment="Stretch"
                              HorizontalAlignment="Stretch"
                              Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="ActionLogTemplate">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse Grid.Column="0"
                                 Height="42"
                                 Width="42"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Center"
                                 StrokeThickness="0"
                                 Margin="10 5"
                                 Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1"
                          HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid BorderBrush="#FF252525"
                              MinHeight="50"
                              MaxWidth="360"
                              BorderThickness="1"
                              CornerRadius="25"
                              Margin="5">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Foreground="#FFCDCDCD"
                                       FontFamily="{StaticResource VazirFont}"
                                       FontSize="{StaticResource TinyFontSize}"
                                       TextWrapping="Wrap"
                                       TextAlignment="DetectFromContent"
                                       VerticalAlignment="Center"
                                       Margin="15 2"
                                       DataContext="{Binding ActionLog.Description}"
                                       DataContextChanged="TextBlockDataContextChanged" />
                            <Grid Grid.Row="1"
                                  HorizontalAlignment="Right">
                                <TextBlock Foreground="#FF858585"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="10.5"
                                           TextWrapping="NoWrap"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="0 0 10 5"
                                           Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}" />

                            </Grid>

                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Name="ProfileGridViewTemplate">
                <controls:ImageEx Stretch="UniformToFill"
                                  Height="65"
                                  Width="65">
                    <controls:ImageEx.Source>
                        <BitmapImage UriSource="{Binding Images[0].Uri}" />
                    </controls:ImageEx.Source>
                </controls:ImageEx>
            </DataTemplate>

        </ResourceDictionary>
    </Page.Resources>
    <Page.DataContext>
        <vm:ThreadViewModel x:Name="ThreadVM"
                            x:FieldModifier="public" />
    </Page.DataContext>
    <Grid Background="{StaticResource DefaultBackgroundColor}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <MediaElement x:Name="ME"
                      Opacity="0"
                      AutoPlay="False"
                      MediaOpened="MEMediaOpened"
                      MediaEnded="MEMediaEnded"
                      MediaFailed="MEMediaFailed" />
        <SplitView x:Name="SplitView"
                   CompactPaneLength="0"
                   DisplayMode="CompactOverlay"
                   PaneBackground="#E5141414"
                   OpenPaneLength="240"
                   IsTabStop="False"
                   Foreground="White"
                   PanePlacement="Right"
                   IsPaneOpen="False">
            <SplitView.Pane>
                <Grid x:Name="UsersGrid"
                      Grid.Column="1"
                      Grid.RowSpan="2"
                      Width="240">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <!--<controls:GridSplitter Width="11"
                                   ResizeBehavior="BasedOnAlignment"
                                   ResizeDirection="Auto"
                                   Background="#FF343434"
                                   Foreground="White"
                                   FontSize="13">
                <controls:GridSplitter.Element>
                    <Grid>
                        <TextBlock HorizontalAlignment="Center"
                                   IsHitTestVisible="False"
                                   VerticalAlignment="Center"
                                   Text="&#xE784;"
                                   Foreground="White"
                                   FontFamily="Segoe MDL2 Assets">
                        </TextBlock>
                    </Grid>
                </controls:GridSplitter.Element>
            </controls:GridSplitter>-->
                    <Grid Width="1"
                          Background="#FF212121" />
                    <ScrollViewer Grid.Column="1">
                        <StackPanel>

                            <TextBox x:Name="TextThreadTitle"
                                     Margin="2 12 0 0"
                                     Foreground="White"
                                     Text="{Binding CurrentThread.Title, Mode=TwoWay}"
                                     IsEnabled="False"
                                     FontFamily="{StaticResource VazirFont}"
                                     AcceptsReturn="True"
                                     PlaceholderText="Thread title..."
                                     IsSpellCheckEnabled="False"
                                     FontSize="{StaticResource DefaultFontSize}"
                                     TextWrapping="Wrap"
                                     Style="{StaticResource CommentTextBoxCenter}"
                                     TextAlignment="DetectFromContent"
                                     VerticalAlignment="Center"
                                     Grid.Column="1"
                                     BorderThickness="1"
                                     Background="{x:Null}" />

                            <Grid x:Name="ApprovalGrid"
                                  Margin="0 5"
                                  Visibility="{Binding ApprovalAdminVisibility, Mode=TwoWay}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock TextWrapping="Wrap"
                                           Text="Approval required to join"
                                           Margin="6 4"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Left"
                                           FontSize="{StaticResource DefaultFontSize}"
                                           FontFamily="{StaticResource VazirFont}" />
                                <ToggleSwitch x:Name="toggleApprovalGrid"
                                              Style="{StaticResource ToggleSwitchStyle}"
                                              HorizontalAlignment="Right"
                                              OffContent="{x:Null}"
                                              OnContent=""
                                              Grid.Column="2"
                                              Toggled="ToggleApprovalGridToggled" />
                            </Grid>
                            <Rectangle Fill="#FF363636"
                                       Height="1.5"
                                       Grid.Row="1"
                                       Grid.ColumnSpan="3"
                                       Margin="5 2.5"
                                       HorizontalAlignment="Stretch"
                                       VerticalAlignment="Stretch" />
                            <Grid Grid.Column="1"
                                  Margin="6 0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <TextBlock Foreground="White"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="{StaticResource DefaultFontSize}"
                                           TextWrapping="Wrap"
                                           VerticalAlignment="Center"
                                           Margin="2 10"
                                           Text="Members" />
                                <StackPanel x:Name="AddMemberStack"
                                            Grid.Row="2"
                                            Visibility="{Binding AddMemberVisibility}">

                                    <Rectangle Fill="#FF363636"
                                               Height="1.5"
                                               Grid.Row="1"
                                               Grid.ColumnSpan="3"
                                               Margin="15 2.5"
                                               HorizontalAlignment="Stretch"
                                               VerticalAlignment="Stretch" />
                                    <ToggleButton x:Name="AddPeopleToggleButton"
                                                  Grid.Row="2"
                                                  Content="Add People..."
                                                  Style="{StaticResource HeaderToggleButtonWithoutIconStyle}"
                                                  Background="Transparent"
                                                  Tag=""
                                                  FontSize="{StaticResource DefaultFontSize}"
                                                  FontFamily="{StaticResource VazirFont}"
                                                  Margin="4 10"
                                                  Click="AddPeopleToggleButtonButtonClick" />
                                </StackPanel>
                                <Rectangle Fill="#FF363636"
                                           Height="1.5"
                                           Grid.Row="3"
                                           Grid.ColumnSpan="3"
                                           Margin="15 2.5"
                                           HorizontalAlignment="Stretch"
                                           VerticalAlignment="Stretch" />
                                <ListView x:Name="UsersLV"
                                          Grid.Row="4"
                                          Foreground="{StaticResource DefaultInnerForegroundColor}"
                                          SelectionMode="None"
                                          Margin="5"
                                          ItemTemplateSelector="{StaticResource ThreadItemTemplateSelector}"
                                          ItemsSource="{Binding Users, Mode=OneWay}"
                                          HorizontalAlignment="Stretch"
                                          VerticalAlignment="Stretch"
                                          IsItemClickEnabled="True"
                                          ItemClick="UsersLVItemClick">
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem">
                                            <Setter Property="VerticalContentAlignment"
                                                    Value="Stretch" />
                                            <Setter Property="HorizontalContentAlignment"
                                                    Value="Stretch" />
                                            <Setter Property="Margin"
                                                    Value="2" />
                                            <Setter Property="Padding"
                                                    Value="0" />
                                        </Style>
                                    </ListView.ItemContainerStyle>
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid Height="65"
                                                      Margin="5 0 5 0">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="60" />
                                                        <ColumnDefinition Width="3" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Ellipse Grid.Column="0"
                                                             Height="55"
                                                             Width="55"
                                                             VerticalAlignment="Center"
                                                             HorizontalAlignment="Center"
                                                             StrokeThickness="0">
                                                        <Ellipse.Fill>
                                                            <ImageBrush ImageSource="{Binding ProfilePicture}" />
                                                        </Ellipse.Fill>
                                                    </Ellipse>
                                                    <TextBlock Foreground="{StaticResource DefaultInnerForegroundColor}"
                                                               FontFamily="{StaticResource VazirFont}"
                                                               FontSize="{StaticResource TinyFontSize}"
                                                               Grid.Column="2"
                                                               Text="{Binding UserName}"
                                                               VerticalAlignment="Center"
                                                               Margin="0 8 0 8" />


                                                </Grid>

                                            </Grid>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>

                            </Grid>
                            <Rectangle Fill="#FF363636"
                                       Height="1.5"
                                       Grid.Row="1"
                                       Grid.ColumnSpan="3"
                                       Margin="5 2.5"
                                       HorizontalAlignment="Stretch"
                                       VerticalAlignment="Stretch" />
                            <Grid x:Name="LeaveChatGrid"
                                  Margin="6 0"
                                  Visibility="{Binding LeaveChatVisibility}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <ToggleButton x:Name="LeaveChatToggleButton"
                                              Content="Leave chat"
                                              Style="{StaticResource HeaderToggleButtonRemovedIconStyle}"
                                              Background="Transparent"
                                              Tag=""
                                              FontSize="{StaticResource HeaderFontSize}"
                                              FontFamily="{StaticResource VazirFont}"
                                              Margin="6 10"
                                              Click="LeaveChatToggleButtonClick"
                                              Foreground="#FFFA5E5E" />
                                <TextBlock Foreground="#FFBCBCBC"
                                           Grid.Row="1"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="{StaticResource TinyFontSize}"
                                           TextWrapping="Wrap"
                                           VerticalAlignment="Center"
                                           FontStyle="Italic"
                                           Margin="6 2"
                                           Text="You won't receive messages from this group unless someone adds you to the conversation again." />
                            </Grid>

                            <Rectangle Fill="#FF363636"
                                       Height="1.5"
                                       Grid.Row="1"
                                       Grid.ColumnSpan="3"
                                       Margin="5 2.5"
                                       HorizontalAlignment="Stretch"
                                       VerticalAlignment="Stretch" />
                            <Grid x:Name="EndChatGrid"
                                  Margin="6 0"
                                  Visibility="{Binding EndChatVisibility}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <ToggleButton x:Name="EndChatToggleButton"
                                              Content="End chat"
                                              Style="{StaticResource HeaderToggleButtonRemovedIconStyle}"
                                              Background="Transparent"
                                              Tag=""
                                              FontSize="{StaticResource HeaderFontSize}"
                                              FontFamily="{StaticResource VazirFont}"
                                              Margin="6 10"
                                              Click="EndChatToggleButtonClick"
                                              Foreground="#FFFA5E5E" />
                                <TextBlock Foreground="#FFBCBCBC"
                                           Grid.Row="1"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="{StaticResource TinyFontSize}"
                                           TextWrapping="Wrap"
                                           VerticalAlignment="Center"
                                           FontStyle="Italic"
                                           Margin="6 2"
                                           Text="All group members will be removed from this chat. They still will able to view the chat history." />
                            </Grid>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>

            </SplitView.Pane>
            <SplitView.Content>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" MaxHeight="70" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Foreground="White"
                                   FontFamily="{StaticResource VazirFont}"
                                   FontSize="{StaticResource DefaultFontSize}"
                                   TextWrapping="Wrap"
                                   VerticalAlignment="Center"
                                   Margin="12 8 5 2"
                                   Text="{Binding CurrentThread.Title,Mode=TwoWay}" />
                        <TextBlock Foreground="#FF919191"
                                   FontFamily="{StaticResource VazirFont}"
                                   FontSize="{StaticResource TinyFontSize}"
                                   TextWrapping="Wrap"
                                   VerticalAlignment="Center"
                                   Grid.Row="1"
                                   Margin="16 2 5 2"
                                   Text="{Binding TypingText, Mode=TwoWay}"
                                   Visibility="{Binding TypingVisibility, Mode=TwoWay}" />
                        <ToggleButton x:Name="MenuButton"
                                      Grid.Column="1"
                                      Grid.RowSpan="2"
                                      TabIndex="1"
                                      Style="{StaticResource SplitViewTogglePaneButtonStyle2}"
                                      HorizontalAlignment="Right"
                                      Content="&#xE700;"
                                      AutomationProperties.Name="Menu"
                                      Click="MenuButtonClick">
                        </ToggleButton>
                        <!---->
                    </Grid>
                    <Rectangle Fill="#FF363636"
                               Height="1.5"
                               Grid.Row="1"
                               Grid.ColumnSpan="3"
                               Margin="10 2.5"
                               HorizontalAlignment="Stretch"
                               VerticalAlignment="Stretch" />
                    <Grid Grid.Row="2">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <loading:LoadingUc x:Name="TopLoading"
                                           Visibility="Collapsed"
                                           VerticalAlignment="Top" />
                        <ListView x:Name="ItemsLV"
                                  x:FieldModifier="public"
                                  Foreground="{StaticResource DefaultInnerForegroundColor}"
                                  SelectionMode="None"
                                  Grid.Row="1"
                                  Margin="5"
                                  ItemTemplateSelector="{StaticResource ThreadItemTemplateSelector}"
                                  ItemsSource="{Binding Items, Mode=OneWay}"
                                  HorizontalAlignment="Stretch"
                                  VerticalAlignment="Stretch"
                                  IsItemClickEnabled="False">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="VerticalContentAlignment"
                                            Value="Stretch" />
                                    <Setter Property="HorizontalContentAlignment"
                                            Value="Stretch" />
                                    <Setter Property="Margin"
                                            Value="2" />
                                    <Setter Property="Padding"
                                            Value="0" />
                                </Style>
                            </ListView.ItemContainerStyle>
                        </ListView>

                        <ListView x:Name="LVGiphy"
                                  SelectionMode="None"
                                  Foreground="White"
                                  Grid.Row="2"
                                  Margin="14 0"
                                  ItemsSource="{Binding GiphsItems}"
                                  ScrollViewer.HorizontalScrollMode="Enabled"
                                  ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                  ScrollViewer.VerticalScrollMode="Disabled"
                                  ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                  IsItemClickEnabled="True"
                                  ItemClick="LVGiphyItemClick">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="HorizontalContentAlignment"
                                            Value="Center" />
                                    <Setter Property="Margin"
                                            Value="0" />
                                    <Setter Property="Padding"
                                            Value="0 5 5 5" />
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <ItemsStackPanel Orientation="Horizontal" />
                                </ItemsPanelTemplate>
                            </ListView.ItemsPanel>
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Width="{Binding Images.FixedWidth.Width}"
                                          Height="135"
                                          BorderBrush="#FF252525"
                                          Background="#FF1D1C1C"
                                          BorderThickness="1"
                                          CornerRadius="25">
                                        <Image Stretch="Fill"
                                               HorizontalAlignment="Stretch"
                                               VerticalAlignment="Stretch"
                                               gif:AnimationBehavior.AutoStart="True"
                                               gif:AnimationBehavior.RepeatBehavior="Forever"
                                               gif:AnimationBehavior.SourceUri="{Binding Images.FixedWidth.Url, Converter={StaticResource StringToUriConverter}}" />

                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>

                        </ListView>

                        <Grid Grid.Row="3">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <uc:RecordDirectVoiceUc x:Name="RecordDirectVoiceUc"
                                                    x:FieldModifier="public"
                                                    Visibility="Collapsed" />
                            <Grid BorderBrush="#FF252525"
                                  Grid.Row="1"
                                  MinHeight="50"
                                  BorderThickness="2"
                                  CornerRadius="25"
                                  Margin="5 5 5 8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <AppBarButton x:Name="CameraButton"
                                              Foreground="{StaticResource DefaultForegroundColor}"
                                              Content=""
                                              FontFamily="{StaticResource MaterialSymbolFont}"
                                              FontSize="{StaticResource BigFontSize}"
                                              Click="CameraButtonClick"
                                              VerticalAlignment="Center" />
                                
                                <AppBarButton x:Name="SendButton"
                                              Foreground="{StaticResource DefaultForegroundColor}"
                                              Visibility="Collapsed"
                                              VerticalAlignment="Center"
                                              Grid.Column="2"
                                              Content="Send"
                                              Width="75"
                                              FontFamily="{StaticResource VazirFont}"
                                              FontSize="{StaticResource DefaultFontSize}"
                                              Click="SendButtonClick" />
                                <TextBox x:Name="TextMessage"
                                         Margin="1"
                                         Foreground="White"
                                         FontFamily="{StaticResource VazirFont}"
                                         AcceptsReturn="True"
                                         PlaceholderText="Write a message..."
                                         IsSpellCheckEnabled="False"
                                         FontSize="{StaticResource DefaultFontSize}"
                                         TextWrapping="Wrap"
                                         Style="{StaticResource CommentTextBoxCenter}"
                                         TextAlignment="DetectFromContent"
                                         VerticalAlignment="Center"
                                         Grid.Column="1"
                                         MaxHeight="150"
                                         BorderThickness="0"
                                         Background="{x:Null}"
                                         LostFocus="TextMessageLostFocus"
                                         TextChanging="TextMessageTextChanging" />

                                <Border x:Name="RecordInfoBorder"
                                        Visibility="Collapsed"
                                        Background="{StaticResource DefaultBackgroundColor}"
                                         Margin="0,0,48,0"
                                         Grid.ColumnSpan="5"
                                         Grid.Row="1">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <StackPanel x:Name="ElapsedPanel"
                                                    SizeChanged="ElapsedPanel_SizeChanged"
                                                    Orientation="Horizontal"
                                                     HorizontalAlignment="Left">
                                            <Ellipse Fill="#FFFA2929"
                                                     Width="12"
                                                     Height="12"
                                                     Margin="12,0,8,0" />
                                            <TextBlock x:Name="ElapsedLabel"
                                                       Text="0:00,00"
                                                       Margin="0,0,0,1"
                                                       Width="64"
                                                       VerticalAlignment="Center" />
                                        </StackPanel>
                                        <StackPanel x:Name="SlidePanel"
                                                    SizeChanged="SlidePanel_SizeChanged"
                                                    Orientation="Horizontal"
                                                    HorizontalAlignment="Right"
                                                    Margin="0,0,84,0"
                                                    Grid.Column="1">
                                            <FontIcon Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                                                      Glyph="&#xE00E;"
                                                      FontSize="12"
                                                      Margin="0,1,4,0" />
                                            <TextBlock Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                                                       Text="SLIDE TO CANCEL"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,0,0"
                                                       Style="{StaticResource CaptionTextBlockStyle}" />
                                        </StackPanel>


                                        <HyperlinkButton x:Name="ButtonCancelRecording"
                                                         Click="ButtonCancelRecording_Click"
                                                         Content="Cancel"
                                                         HorizontalAlignment="Center"
                                                         Visibility="Collapsed"
                                                         Grid.ColumnSpan="4"
                                                         Grid.Row="1" />
                                    </Grid>
                                </Border>
                                  




                                <Grid x:Name="RightGrid"
                                      Grid.Column="2"
                                      VerticalAlignment="Center">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>



                                    <!--<AppBarButton x:Name="VoiceButton"
                                                  Foreground="{StaticResource DefaultForegroundColor}"
                                                  Grid.Column="0"
                                                  Content=""
                                                  VerticalAlignment="Center"
                                                  FontFamily="{StaticResource MaterialSymbolFont}"
                                                  FontSize="{StaticResource BigFontSize}"
                                                  Click="VoiceButtonClick" />-->
                                    <AppBarButton x:Name="FileSelectButton"
                                                  Foreground="{StaticResource DefaultForegroundColor}"
                                                  Grid.Column="0"
                                                  Content="ﱩ"
                                                  VerticalAlignment="Center"
                                                  FontFamily="{StaticResource MaterialSymbolFont}"
                                                  FontSize="{StaticResource BigBigFontSize}"
                                                  Click="FileSelectButtonClick" />
                                    <AppBarButton x:Name="PlusButton"
                                                  Foreground="{StaticResource DefaultForegroundColor}"
                                                  Grid.Column="1"
                                                  Content=""
                                                  VerticalAlignment="Center"
                                                  FontFamily="{StaticResource MaterialSymbolFont}"
                                                  FontSize="{StaticResource BigFontSize}"
                                                  Click="PlusButtonClick">
                                        <AppBarButton.Flyout>
                                            <MenuFlyout Placement="Top">
                                                <MenuFlyoutItem x:Name="GiphyMenuFlyoutItem"
                                                                Text="Gif"
                                                                Height="42"
                                                                FontFamily="{StaticResource VazirFont}"
                                                                FontSize="{StaticResource BigFontSize}"
                                                                Click="GiphyMenuFlyoutItemClick"
                                                                HorizontalContentAlignment="Center" />


                                                <MenuFlyoutItem x:Name="HeartMenuFlyoutItem"
                                                                Text=""
                                                                Foreground="#FFE03939"
                                                                FontFamily="{StaticResource MaterialSymbolFont}"
                                                                FontSize="{StaticResource HeavyBigFontSize}"
                                                                Click="HeartMenuFlyoutItemClick"
                                                                HorizontalContentAlignment="Center" />
                                            </MenuFlyout>
                                        </AppBarButton.Flyout>
                                        <!--<FlyoutBase.AttachedFlyout>
                                <MenuFlyout Placement="Top" >
                                    <MenuFlyoutItem x:Name="GiphyMenuFlyoutItem"
                                                    Text="Gif"
                                                    Height="42"
                                                    FontFamily="{StaticResource VazirFont}"
                                                    FontSize="{StaticResource BigFontSize}"
                                                    Click="GiphyMenuFlyoutItemClick"
                                                    HorizontalAlignment="Center"
                                                    HorizontalContentAlignment="Center" />


                                    <MenuFlyoutItem x:Name="HeartMenuFlyoutItem"
                                                    Text="❤️"
                                                    Foreground="#FFE03939"
                                                    FontFamily="{StaticResource VazirFont}"
                                                    FontSize="{StaticResource BigFontSize}"
                                                    Click="HeartMenuFlyoutItemClick"
                                                    HorizontalAlignment="Center"
                                                    HorizontalContentAlignment="Center" />
                                </MenuFlyout>
                            </FlyoutBase.AttachedFlyout>-->

                                    </AppBarButton>


                                    <Grid x:Name="ButtonRecord"
                                          VerticalAlignment="Bottom"
                                          Width="58"
                                          Height="52"
                                          Grid.Column="2"
                                          Canvas.ZIndex="1000">
                                        <Border x:Name="Ellipse"
                                                Background="#FF0068FF"
                                                Width="58"
                                                Height="52"
                                                Margin="0 0 -7 0"
                                                Visibility="Collapsed"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center" />
                                        <localControls:ChatRecordButton x:Name="btnVoiceMessage"
                                                                        AllowFocusOnInteraction="False"
                                                                        RecordingStarted="VoiceButton_RecordingStarted"
                                                                        RecordingStopped="VoiceButton_RecordingStopped"
                                                                        RecordingLocked="VoiceButton_RecordingLocked"
                                                                        ManipulationDelta="VoiceButton_ManipulationDelta"
                                                                        ManipulationMode="TranslateX,TranslateY" />
                                    </Grid>
                                </Grid>

                          
                            </Grid>

                        </Grid>
                    </Grid>
                </Grid>
            </SplitView.Content>
        </SplitView>



        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="khar">

                <VisualState x:Name="VisualStateSecond">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="718" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="SplitView.DisplayMode"
                                Value="CompactInline" />
                        <Setter Target="SplitView.IsPaneOpen"
                                Value="True" />
                        <!--<Setter Target="UsersGrid.Visibility"
                                Value="Visible" />-->

                    </VisualState.Setters>
                </VisualState>
                <!--<VisualState x:Name="VisualStateDefault">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0" />
                    </VisualState.StateTriggers>

                    <VisualState.Setters>

                        <Setter Target="UsersGrid.Visibility"
                                Value="Collapsed" />
            
                    </VisualState.Setters>
                </VisualState>-->

            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>

    </Grid>
</Page>
